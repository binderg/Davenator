<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1'>

	<title>Svelte app</title>

	<link rel='icon' type='image/png' href='/favicon.png'>
	<link rel='stylesheet' href='/global.css'>
	<link rel='stylesheet' href='/build/bundle.css'>
	
	<!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- This loads the standalone build from the CDN -->
	<script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.18.9/package/dist/xlsx.full.min.js"></script>

	<script src="https://cdn.tailwindcss.com"></script>

	  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script> -->
	
	<script defer src='/build/bundle.js'></script>
</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col-12 text-center text-3xl	"><h2>Davenator</h2></div>
			<div class="col-12">
				<div id="custom-search-input">
					<div class="input-group">
						<input id="autocomplete_search" name="autocomplete_search" type="text" class="form-control" placeholder="Location" />
						<input type="hidden" id ="lat" name="lat">
						<input type="hidden" id ="long" name="long">
					</div>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvQBjBzOIihWhd9_dUPqhhlseMCJAeCIc&libraries=places"></script>
         
	<script>
		
	  google.maps.event.addDomListener(window, 'load', initialize);
		function initialize() {
		  var input = document.getElementById('autocomplete_search');
		  var autocomplete = new google.maps.places.Autocomplete(input);
		  autocomplete.addListener('place_changed', function () {
		  var place = autocomplete.getPlace();
		  // place variable will have all the information you are looking for.
		  let lat = document.getElementById('lat').setAttribute('value', place.geometry['location'].lat())
		  let long =document.getElementById('long').setAttribute('value', place.geometry['location'].lng())
		  //   let lat = $('#lat').val(place.geometry['location'].lat());
		  //   let long =$('#long').val(place.geometry['location'].lng());
		  //let location = getGeoInfo(place.place_id);
		  getGeoInfo(place.place_id).then(geoInfo => {
  					console.log(JSON.stringify(geoInfo.results[0].geometry.location)); // fetched geoInfo
				});
	
		});
	  }

	  async function getGeoInfo(place_id) {
    const res = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?place_id=${place_id}&key=AIzaSyBvQBjBzOIihWhd9_dUPqhhlseMCJAeCIc&libraries=places`);

    if (res.ok) {
		return res.json();
  }
}
	</script>
</body>
</html>
